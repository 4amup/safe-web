{% extends "layout.njk" %}
{# 首页自定义样式文件 #}
{% block stylesheets %}
<link rel="stylesheet" href="css/index.css">
{% endblock %}

{% block content %}
<h1>{{ title }}</h1>
<div class="container">
  <div id="map" style="min-width:600px; min-height:600px"></div>
  <form action="/upload" method="post" enctype="multipart/form-data" id="form">
    <p>
      <label for="image">图片上传</label>
      <input type="file" id="chooseImage" name="image">
    </p>
    <p>
      <label for="description">问题描述</label>
      <textarea name="description" id="troubleDescription" cols="30" rows="10"></textarea>
    </p>
    <p>
      <input type="submit" value="提交">
    </p>
  </form>
</div>
<script src="js/index.js"></script>
<script>
// 循环区
{# var markers = new Array({{ troubles.length }});
{% for trouble in troubles %}

var location{{trouble.id - 1}} = new qq.maps.LatLng({{ trouble.Lng }}, {{ trouble.Lat }});
markers[{{ trouble.id - 1}}] = new qq.maps.Marker({
position: location{{trouble.id - 1}},
map: map,
});
markers[{{ trouble.id - 1}}].setIcon(icon); // 添加icon

var trouble{{trouble.id - 1}} = `<div><h1 style="text-align:center">{{ trouble.imageDescription }}</h1><img style="width:400px; height:200px;" src={{ trouble.imagePath }}></div>`;

qq.maps.event.addListener(markers[{{ trouble.id - 1}}], 'click', function() {
  info.open();
  info.setContent(trouble{{trouble.id - 1}});
  info.setPosition(location{{trouble.id - 1}});
});
{% endfor %} #}
</script>
{% endblock %}